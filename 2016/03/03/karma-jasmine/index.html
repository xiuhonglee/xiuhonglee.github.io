<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="description" content="随便写写~"><meta name="viewport" content="width=device-width, initial-scale=1"><title>karma集成jasmine框架 · xiuhong</title><link rel="short icon" href="/favicon.ico"><!-- font--><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,600|Roboto Mono"><!-- icon--><link rel="stylesheet" href="/fonts/iconfont/iconfont.css"><!-- theme style--><link rel="stylesheet" href="/css/style.css"><!-- baidu analytics--><script type="text/javascript">var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?9e0cbea7d3319c6c94c71dfb93c151b8";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><!-- google analytics--><script type="text/javascript">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-74273646-1', 'auto');
ga('send', 'pageview');</script></head><body><div id="main"><header><a href="/." class="logo">xiuhong</a><ul class="nav"><li class="nav-link"><a href="/" target="_self">Home</a></li><li class="nav-link"><a href="/archives/" target="_self">Archives</a></li><li class="nav-link"><a href="/categories/" target="_self">Categories</a></li><li class="nav-link"><a href="/tags/" target="_self">Tags</a></li><li class="nav-link"><a href="/about/" target="_self">About</a></li></ul></header><section id="container"><article class="post"><h1 class="post-title">karma集成jasmine框架</h1><span class="post-time">Mar 3, 2016</span><div id="sidebar" class="post-sidebar"><h3 class="heading">Directory</h3><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#u672C_u8282_u5185_u5BB9"><span class="toc-text">本节内容</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#karma_u914D_u7F6E_u6587_u4EF6"><span class="toc-text">karma配置文件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#u5927_u6982_u4ECB_u7ECD_u4E0Bkarma_u7684_u5B9E_u73B0_u539F_u7406"><span class="toc-text">大概介绍下karma的实现原理</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#karma_u793A_u4F8B"><span class="toc-text">karma示例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#u53C2_u8003_u8FDE_u63A5"><span class="toc-text">参考连接</span></a></div><div class="post-content"><h4 id="u672C_u8282_u5185_u5BB9"><a href="#u672C_u8282_u5185_u5BB9" class="headerlink" title="本节内容"></a>本节内容</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">karma介绍</div><div class="line">karma配置文件</div><div class="line">karma示例</div></pre></td></tr></table></figure>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># karma构建在Node.js之上，以npm包形式安装</span></div><div class="line">$ npm install karma --save-dev</div><div class="line"></div><div class="line"><span class="comment"># 安装插件，因为要集成jasmine</span></div><div class="line">$ npm install karma-jasmine karma-chrome-launcher --save-dev</div><div class="line"></div><div class="line"><span class="comment"># 运行Karma</span></div><div class="line">$ ./node_modules/karma/bin/karma start</div><div class="line"></div><div class="line"><span class="comment"># 可以安装命令行接口（全局安装）</span></div><div class="line">$ npm install -g karma-cli</div><div class="line"></div><div class="line"><span class="comment"># 然后就可以这样运行</span></div><div class="line">$ karma start</div></pre></td></tr></table></figure>
<h4 id="karma_u914D_u7F6E_u6587_u4EF6"><a href="#karma_u914D_u7F6E_u6587_u4EF6" class="headerlink" title="karma配置文件"></a>karma配置文件</h4><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 初始化配置文件，可自行配置</span></div><div class="line"><span class="comment"># 可以参考这个：http://html-js.com/article/The-front-end-of-the-front-road-automation-test-automation-test-road--the-karma-configuration</span></div><div class="line"></div><div class="line">$ karma init </div><div class="line"></div><div class="line"><span class="comment"># 生成配置文件后，也可以这么启动karma </span></div><div class="line">$ karma karma.conf.js</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>karma配置文件,官网(<a href="https://karma-runner.github.io/0.13/config/configuration-file.html" target="_blank" rel="external">https://karma-runner.github.io/0.13/config/configuration-file.html</a>)<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Karma configuration</span></div><div class="line"><span class="comment">// Generated on Mon Feb 29 2016 16:23:28 GMT+0800 (CST)</span></div><div class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span>(<span class="params">config</span>) </span>&#123;</div><div class="line">  config.set(&#123;</div><div class="line"></div><div class="line">    <span class="comment">// 用来解析定义在files和exclude里的相对路径的根目录</span></div><div class="line">    <span class="comment">// 如果basePath是一个相对路径，那么它会被解析为相对于配置文件的__dirname</span></div><div class="line">    basePath: <span class="string">'./'</span>,</div><div class="line"></div><div class="line">    <span class="comment">// 测试框架</span></div><div class="line">    frameworks: [<span class="string">'jasmine'</span>],</div><div class="line"></div><div class="line">    <span class="comment">// 被加载到浏览器的js文件（被测试文件、测试文件）</span></div><div class="line">    files: [<span class="string">'public/js/src.js'</span>,<span class="string">'public/js/test.js'</span>,<span class="string">'test/srcSpec.js'</span>],</div><div class="line"></div><div class="line">    <span class="comment">// 不会被加载到浏览器的js文件（过滤掉无用js）</span></div><div class="line">    exclude: [<span class="string">'karma.conf.js'</span>],</div><div class="line"></div><div class="line">    <span class="comment">// preprocess matching files before serving them to the browser</span></div><div class="line">    <span class="comment">// available preprocessors: https://npmjs.org/browse/keyword/karma-preprocessor</span></div><div class="line">    <span class="comment">// 用到的预处理器映射表</span></div><div class="line">    <span class="comment">// 默认值&#123;’*/.coffee’: ‘coffee’&#125;</span></div><div class="line">    preprocessors: &#123;&#125;,</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// test results reporter to use</span></div><div class="line">    <span class="comment">// possible values: 'dots', 'progress'</span></div><div class="line">    <span class="comment">// available reporters: https://npmjs.org/browse/keyword/karma-reporter</span></div><div class="line">    reporters: [<span class="string">'progress'</span>],</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// web server port</span></div><div class="line">    port: <span class="number">9876</span>,</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// enable / disable colors in the output (reporters and logs)</span></div><div class="line">    colors: <span class="literal">true</span>,</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// level of logging</span></div><div class="line">    <span class="comment">// possible values: config.LOG_DISABLE || config.LOG_ERROR || config.LOG_WARN || config.LOG_INFO || config.LOG_DEBUG</span></div><div class="line">    logLevel: config.LOG_INFO,</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// 文件改动 / 保存会自行执行测试</span></div><div class="line">    autoWatch: <span class="literal">true</span>,</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// start these browsers</span></div><div class="line">    <span class="comment">// available browser launchers: https://npmjs.org/browse/keyword/karma-launcher</span></div><div class="line">    browsers: [<span class="string">'Chrome'</span>],</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// Continuous Integration mode</span></div><div class="line">    <span class="comment">// if true, Karma captures browsers, runs the tests and exits</span></div><div class="line">    singleRun: <span class="literal">false</span>,</div><div class="line"></div><div class="line">    <span class="comment">// Concurrency level</span></div><div class="line">    <span class="comment">// how many browser should be started simultaneous</span></div><div class="line">    concurrency: <span class="literal">Infinity</span></div><div class="line">  &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h5 id="u5927_u6982_u4ECB_u7ECD_u4E0Bkarma_u7684_u5B9E_u73B0_u539F_u7406"><a href="#u5927_u6982_u4ECB_u7ECD_u4E0Bkarma_u7684_u5B9E_u73B0_u539F_u7406" class="headerlink" title="大概介绍下karma的实现原理"></a>大概介绍下karma的实现原理</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># karma是一个工具，用来创建一个web server，web server会到每一连接上的浏览器中执行测试代码</span></div><div class="line"><span class="comment"># 每一个浏览器的测试结果都会通过命令行展示出来</span></div><div class="line"><span class="comment"># karma主要设计用来做底层级的测试（单元测试）。高级测试，推荐protractor（没用过）~~</span></div></pre></td></tr></table></figure>
<h4 id="karma_u793A_u4F8B"><a href="#karma_u793A_u4F8B" class="headerlink" title="karma示例"></a>karma示例</h4><p>项目结构<br><img src="/uploads/karma-jasmine.png" alt=""><br><a href="https://github.com/xiuhonglee/express-node" target="_blank" rel="external">测试项目地址</a><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// test.js 被测试文件</span></div><div class="line"><span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> a + b;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// src.js 被测试文件</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">reverse</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> name.split(<span class="string">""</span>).reverse().join(<span class="string">""</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// srcSpec.js 两个测试用例</span></div><div class="line">describe(<span class="string">"A suite of basic functions"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    it(<span class="string">"reverse word"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        expect(<span class="string">"DCBA"</span>).toEqual(reverse(<span class="string">"ABCD"</span>));</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    it(<span class="string">"add fn"</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        expect(<span class="number">7</span>).toEqual(add(<span class="number">3</span>, <span class="number">4</span>));</div><div class="line">    &#125;);</div><div class="line">    </div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>启动karma测试<br><img src="/uploads/karma-jasmine02.png" alt=""></p>
<h2 id="u53C2_u8003_u8FDE_u63A5"><a href="#u53C2_u8003_u8FDE_u63A5" class="headerlink" title="参考连接"></a>参考连接</h2><ol>
<li><a href="http://www.html-js.com/article/Road-test-automation-entry-frontend-automation-test-front-end--Introduction-to-karma" target="_blank" rel="external">前端自动化测试之路——karma入门</a> </li>
</ol>
</div></article><div class="tags"><a href="/tags/前端测试/">前端测试</a></div><div class="paginator"><a href="/2016/03/03/javascript-date/" class="prev"><i class="iconfont icon-left"></i><span> Prev</span></a><a href="/2016/03/03/jasmine-syntax/" class="next"><span>Next</span><i class="iconfont icon-right"></i></a></div><section id="comments"><div id="disqus_thread"></div></section><script type="text/javascript">(function() {
var d = document, s = d.createElement('script');

s.src = '//ahonn.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script></section><footer><div class="copyright"><p>&copy;2013-2017<span class="heart"><i class="iconfont icon-heart"></i></span><span class="author">修鸿</span></p><p class="theme">Theme by <a href="https://github.com/ahonn/hexo-theme-even"> Even</a></p></div><label id="back2top"><i class="iconfont icon-up"></i></label></footer></div></body><script src="/js/zepto.min.js"></script><script src="/js/theme.js"></script></html>