<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="description" content="随便写写~"><meta name="viewport" content="width=device-width, initial-scale=1"><title>构建对象模型 · xiuhong</title><link rel="short icon" href="/favicon.ico"><!-- font--><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,600|Roboto Mono"><!-- icon--><link rel="stylesheet" href="/fonts/iconfont/iconfont.css"><!-- theme style--><link rel="stylesheet" href="/css/style.css"><!-- baidu analytics--><script type="text/javascript">var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?9e0cbea7d3319c6c94c71dfb93c151b8";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><!-- google analytics--><script type="text/javascript">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-74273646-1', 'auto');
ga('send', 'pageview');</script></head><body><div id="main"><header><a href="/." class="logo">xiuhong</a><ul class="nav"><li class="nav-link"><a href="/" target="_self">Accueil</a></li><li class="nav-link"><a href="/archives/" target="_self">Archives</a></li><li class="nav-link"><a href="/categories/" target="_self">Catégories</a></li><li class="nav-link"><a href="/tags/" target="_self">Tags</a></li><li class="nav-link"><a href="/about/" target="_self">À propos</a></li></ul></header><section id="container"><article class="post"><h1 class="post-title">构建对象模型</h1><span class="post-time">Aug 9, 2016</span><div id="sidebar" class="post-sidebar"><h3 class="heading">Sommaire</h3><ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-__u672C_u8282_u5185_u5BB9"><span class="toc-text">1. 本节内容</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-_Document_Object_Model_28DOM_29"><span class="toc-text">2. Document Object Model(DOM)</span></a></li></ol></div><div class="post-content"><p><a href="https://developers.google.com/web/fundamentals/performance/critical-rendering-path/constructing-the-object-model?hl=en" target="_blank" rel="external">内容来自Google Developer</a></p>
<blockquote>
<p>浏览器在渲染页面之前，需要构建DOM树和CSSOM树。因此，我们需要确保HTML和CSS文件尽快给浏览器解析。  </p>
</blockquote>
<h4 id="1-__u672C_u8282_u5185_u5BB9"><a href="#1-__u672C_u8282_u5185_u5BB9" class="headerlink" title="1. 本节内容"></a>1. 本节内容</h4><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># Document Object Model (DOM)</span><br><span class="line"># CSS Object Model (CSSOM)</span><br></pre></td></tr></table></figure>
<p>简要</p>
<ul>
<li>字节 → 字符 → 标记(tokens) → 节点 → 对象模型</li>
<li>HTML被解析为DOM(Document Object Model),CSS被解析为CSSOM(CSS Object Model)</li>
<li>可以通过Chrome DevTools Timeline来检测浏览器构建DOM树和CSSOM树的流程</li>
</ul>
<h4 id="2-_Document_Object_Model_28DOM_29"><a href="#2-_Document_Object_Model_28DOM_29" class="headerlink" title="2. Document Object Model(DOM)"></a>2. Document Object Model(DOM)</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">meta</span> <span class="attribute">name</span>=<span class="value">"viewport"</span> <span class="attribute">content</span>=<span class="value">"width=device-width,initial-scale=1"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">link</span> <span class="attribute">href</span>=<span class="value">"style.css"</span> <span class="attribute">rel</span>=<span class="value">"stylesheet"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">title</span>&gt;</span>Critical Path<span class="tag">&lt;/<span class="title">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">p</span>&gt;</span>Hello <span class="tag">&lt;<span class="title">span</span>&gt;</span>web performance<span class="tag">&lt;/<span class="title">span</span>&gt;</span> students!<span class="tag">&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">div</span>&gt;</span><span class="tag">&lt;<span class="title">img</span> <span class="attribute">src</span>=<span class="value">"awesome-photo.jpg"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>上例，一段简单的HTML文档包含一段text文本和一张图片。下面来分析浏览器是如何渲染出一张页面的。</p>
</blockquote>
<p><img src="https://developers.google.com/web/fundamentals/performance/critical-rendering-path/images/full-process.png" alt=""></p>
<ul>
<li><strong>转化</strong>：浏览器将从硬盘/网络读到的字节来按照编码规则(如UTF-8)转化为字符串</li>
<li><strong>语义化</strong>：浏览器根据W3C HTML5标准规范将字符串进行语义化解析。- 比如，将”&lt;html&gt;”转化为”<html>“</html></li>
<li><strong>语法分析</strong>：浏览器把语义化标签转化为对象，并为它添加属性和规则</li>
<li><strong>构建DOM树</strong>：HTML语言定义了不同标签之间的关系（有些标签含有嵌套关系），最终这些标签被创建为一个树形结构的对象，此树形结构包含了标签之前最初的的父-子关系：HTML是body的父级元素，body元素又是p标签的父级元素等等</li>
</ul>
<p><img src="https://developers.google.com/web/fundamentals/performance/critical-rendering-path/images/dom-tree.png" alt=""></p>
<blockquote>
<p>浏览器的整个解析过程最终输出一个文档对象模型(Document Object Model)，浏览器将基于此DOM继续后续的页面构建。浏览器每次接收到HTML之后都要重复上面的操作，整个过程会消耗时间，特别处理大量HTML时。</p>
</blockquote>
<p><img src="https://developers.google.com/web/fundamentals/performance/critical-rendering-path/images/dom-timeline.png" alt=""></p>
<ul>
<li><a href="https://developers.google.com/web/tools/chrome-devtools/" target="_blank" rel="external">Chrome Developer Tools 文档</a></li>
<li><a href="http://discover-devtools.codeschool.com/chapters/1/challenges/1?locale=en" target="_blank" rel="external">Chrome Developer Tools视频教程</a></li>
</ul>
<blockquote>
<p>If you open up Chrome DevTools and record a timeline while the page is loaded, you can see the actual time taken to perform this step — in the example above, it took us ~5ms to convert a chunk of HTML bytes into a DOM tree. Of course, if the page was larger, as most pages are, this process might take significantly longer. You will see in our future sections on creating smooth animations that this can easily become your bottleneck if the browser has to process large amounts of HTML.</p>
</blockquote>
</div></article><div class="tags"><a href="/tags/前端性能/">前端性能</a></div><div class="paginator"><a href="/2016/08/09/Critical-rendering-path/" class="next"><span>Suivant</span><i class="iconfont icon-right"></i></a></div><section id="comments"><div id="disqus_thread"></div></section><script type="text/javascript">(function() {
var d = document, s = d.createElement('script');

s.src = '//ahonn.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script></section><footer><div class="copyright"><p>&copy;2013-2016<span class="heart"><i class="iconfont icon-heart"></i></span><span class="author">修鸿</span></p><p class="theme">Theme by <a href="https://github.com/ahonn/hexo-theme-even"> Even</a></p></div><label id="back2top"><i class="iconfont icon-up"></i></label></footer></div></body><script src="/js/zepto.min.js"></script><script src="/js/theme.js"></script></html>